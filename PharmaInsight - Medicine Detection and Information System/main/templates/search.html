<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Medicine Search</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:"Segoe UI",sans-serif;
}

body{
    background:linear-gradient(180deg,#f7fafc,#ffffff);
    color:#222;
}

.container{
    max-width:900px;
    margin:80px auto;
    text-align:center;
    padding:0 20px;
}

h1{
    font-size:34px;
    margin-bottom:10px;
}

.subtitle{
    color:#666;
    margin-bottom:30px;
}

/* TABS */
.tabs{
    display:flex;
    justify-content:center;
    gap:12px;
    margin-bottom:30px;
}

.tab{
    padding:10px 18px;
    border-radius:10px;
    border:1px solid #e0e7ef;
    background:#fff;
    cursor:pointer;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:14px;
}

.tab.active{
    background:#2b7cff;
    color:#fff;
    border-color:#2b7cff;
}

/* SEARCH BOX */
.search-box{
    background:#fff;
    padding:30px;
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,.08);
}

/* TEXT SEARCH */
.text-search input{
    width:100%;
    padding:14px 16px;
    border-radius:10px;
    border:1px solid #dbe4f0;
    font-size:15px;
}

.search-btn{
    margin-top:15px;
    width:100%;
    padding:14px;
    background:#2b7cff;
    color:#fff;
    border:none;
    border-radius:10px;
    font-size:15px;
    cursor:pointer;
}

/* VOICE */
.voice-area{
    padding:40px;
}

.mic{
    width:80px;
    height:80px;
    background:#2b7cff;
    border-radius:50%;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:30px;
    margin:0 auto 15px;
}

/* POPULAR */
.popular{
    margin-top:25px;
    font-size:14px;
    color:#666;
}

.popular span{
    margin:0 8px;
    color:#000;
    cursor:pointer;
}

/* INFO */
.info{
    margin-top:70px;
    opacity:.8;
}

.info i{
    font-size:30px;
    color:#ff6b6b;
    margin-bottom:10px;
}

/* RESULT */
.result {
    margin-top: 40px;
    background: #ffffff;
    padding: 30px;
    border-radius: 18px;
    box-shadow: 0 20px 45px rgba(0,0,0,0.08);
    text-align: left;
}

.meta {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 12px;
    margin-top: 15px;
}

.meta div {
    background: #f4f8ff;
    padding: 12px;
    border-radius: 10px;
    font-size: 14px;
}

.error {
    margin-top: 25px;
    padding: 15px;
    background: #ffe5e5;
    color: #c62828;
    border-radius: 10px;
    font-weight: 500;
}

.hide{display:none;}
</style>
</head>

<body>

{% include "header.html" %}

<div class="container">

<h1>Medicine Search</h1>
<p class="subtitle">
    Search using text or voice to find complete medicine information
</p>

<!-- TABS -->
<div class="tabs">
    <div class="tab active" onclick="showTab('text', event)">
    <i class="fa fa-search"></i> Text Search
    </div>
    <div class="tab" onclick="showTab('voice', event)">
        <i class="fa fa-microphone"></i> Voice Input
    </div>
</div>

<div class="search-box">
<!-- TEXT -->
    <form method="POST">
        <div id="text" class="text-search">
            <input type="text" name="medicine" placeholder="Enter medicine name (e.g., Paracetamol, Aspirin...)" required>
            <button type='submit' class="search-btn" onclick="searchMedicine()">
                <i class="fa fa-search"></i> Search Medicine
            </button>
        </div>
        </form>

         <!-- IMAGE -->
        <div id="image" class="hide">
            <div class="upload-area">
                <i class="fa fa-upload"></i>
                <p><b>Upload Medicine Image</b></p>
                <small>Click or drag & drop medicine strip/bottle</small>
            </div>
            <button class="upload-btn">
                <i class="fa fa-camera"></i> Select Image
            </button>
        </div>

        <!-- VOICE -->
        <div id="voice" class="hide voice-area">
            <div class="mic" onclick="startVoice()">
                <i class="fa fa-microphone"></i>
            </div>
            <p id="voiceText"><b>Tap to Speak</b></p>
            <small>Say the medicine name (e.g., ‚ÄúParacetamol‚Äù)</small>
            
            <form method="POST" id="voiceForm">
                <input type="hidden" name="medicine" id="voiceInput">
            </form>
        </div>
    </form>
</div>


<div class="popular">
    Popular searches:
    <span>Paracetamol</span>
    <span>Aspirin</span>
    <span>Amoxicillin</span>
    <span>Ibuprofen</span>
    <span>Cetirizine</span>
</div>

{% if error %}
<div class="error">‚ö†Ô∏è {{ error }}</div>
{% endif %}

{% if medicine %}
<div class="result">

    <h2>üíä {{ medicine.brand_name }}</h2>

    <!-- üîπ Basic Info -->
    <div class="meta">
        <div><b>Generic Name</b><br>{{ medicine.generic_name }}</div>
        <div><b>Substance</b><br>{{ medicine.substance_name }}</div>
        <div><b>Manufacturer</b><br>{{ medicine.manufacturer }}</div>
        <div><b>Product Type</b><br>{{ medicine.product_type }}</div>
        <div><b>Route</b><br>{{ medicine.route }}</div>
        <div><b>Dosage Form</b><br>{{ medicine.dosage_form }}</div>
    </div>

    <!-- üîπ Medical Usage -->
    <h3>ü©∫ Purpose</h3>
    <p>{{ medicine.purpose }}</p>

    <h3>üìå Uses / Indications</h3>
    <p>{{ medicine.indications_and_usage }}</p>

    <h3>üíä Dosage & Administration</h3>
    <p>{{ medicine.dosage_and_administration }}</p>

    <!-- üîπ Safety -->
    <h3>‚ö†Ô∏è Warnings</h3>
    <p>{{ medicine.warnings }}</p>

    {% if medicine.boxed_warning != "N/A" %}
    <h3>üö® Boxed Warning</h3>
    <p>{{ medicine.boxed_warning }}</p>
    {% endif %}

    <h3>‚õî Contraindications</h3>
    <p>{{ medicine.contraindications }}</p>

    <h3>ü§í Side Effects</h3>
    <p>{{ medicine.adverse_reactions }}</p>

    <h3>üîÑ Drug Interactions</h3>
    <p>{{ medicine.drug_interactions }}</p>

    <h3>‚ò†Ô∏è Overdose</h3>
    <p>{{ medicine.overdosage }}</p>

    <!-- üîπ Special Population -->
    <h3>ü§∞ Pregnancy</h3>
    <p>{{ medicine.pregnancy }}</p>

    <h3>üçº Lactation</h3>
    <p>{{ medicine.lactation }}</p>

    <h3>üë∂ Pediatric Use</h3>
    <p>{{ medicine.pediatric_use }}</p>

    <h3>üë¥ Geriatric Use</h3>
    <p>{{ medicine.geriatric_use }}</p>

    <!-- üîπ Pharmacology -->
    <h3>üß¨ Mechanism of Action</h3>
    <p>{{ medicine.mechanism_of_action }}</p>

    <h3>‚öôÔ∏è Pharmacodynamics</h3>
    <p>{{ medicine.pharmacodynamics }}</p>

    <h3>üî¨ Pharmacokinetics</h3>
    <p>{{ medicine.pharmacokinetics }}</p>

    <!-- üîπ Storage -->
    <h3>üì¶ Storage & Handling</h3>
    <p>{{ medicine.storage_and_handling }}</p>

    <!-- üîπ Regulatory -->
    <div class="meta">
        <div><b>DEA Schedule</b><br>{{ medicine.dea_schedule }}</div>
        <div><b>Application No.</b><br>{{ medicine.application_number }}</div>
        <div><b>SPL ID</b><br>{{ medicine.spl_id }}</div>
        <div><b>Last Updated</b><br>{{ medicine.last_updated }}</div>
    </div>

    <p class="disclaimer">
        ‚ö†Ô∏è <b>Disclaimer:</b> This information is for educational purposes only.
        Always consult a qualified healthcare professional before using any medication.
    </p>

</div>
{% endif %}

<script>

    
function showTab(tab){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    event.target.classList.add('active');

    document.getElementById('text').classList.add('hide');
    document.getElementById('voice').classList.add('hide');

    document.getElementById(tab).classList.remove('hide');
}

function startVoice(){
    if (!('webkitSpeechRecognition' in window)) {
        alert("Voice not supported");
        return;
    }

    const recognition = new webkitSpeechRecognition();
    recognition.lang = "en-US";
    recognition.start();

    recognition.onresult = function(event){
        const text = event.results[0][0].transcript;
        document.getElementById("voiceText").innerText = "You said: " + text;
        document.getElementById("voiceInput").value = text;
        document.getElementById("voiceForm").submit();
    };
}   
</script>

</body>
</html>
